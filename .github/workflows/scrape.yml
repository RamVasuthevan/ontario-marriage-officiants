name: Download and Push File

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 * * *'  # Run daily at UTC midnight

jobs:
  download_and_push:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Download File
        run: |
          curl -o registered_marriage_officiants.csv https://data.ontario.ca/dataset/38ddc983-1bf0-4bee-ad18-07dac8cfe884/resource/e010f610-c3d6-4f88-849b-6f8c11e98d9c/download/registered_marriage_officiants.csv

      - name: Commit and Push if Files Changed
        run: |
          git config user.name "Automated"
          git config user.email "actions@users.noreply.github.com"
          git add registered_marriage_officiants.csv
          timestamp=$(date -u)
          git commit -m "Downloaded: ${timestamp}: commit: ${{github.sha}}" || exit 0
          git push origin ${{github.ref}}

